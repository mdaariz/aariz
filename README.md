# aariz
&lt;?hh  namespace Facebook\ShipIt;  class ShipMyProject   implements \Facebook\ImportIt\ImportItPathMappings {    public static function getPathMappings(): ImmMap&lt;string, string> {     return ImmMap {       'myproject/' => '',     };   }    public static function filterChangeset(     ShipItChangeset $changeset,   ): ShipItChangeset {     return $changeset       |> ShipItPathFilters::stripPaths(           $$,           ImmVector {             '@^(?!myproject/)@',             '@^myproject(/[^/]+)*/MY_PRIVATE_STUFF$@',             '@/non[-_]?public/@',           },         )       |> ShipItPathFilters::moveDirectories(           $$,           self::getPathMappings(),         );   }    public static function cliMain(): void {     $config = new ShipItBaseConfig(       /* default working dir = */ '/var/tmp/shipit',       'source_dir_name',       'dest_dir_name',     );      $phases = ImmVector {       new MySourceRepoInitPhase(/* ... */ ),       new ShipItPullPhase(ShipItRepoSide::SOURCE),       new ShipItGitHubInitPhase(         'my-github-org',         'my-github-project',         ShipItRepoSide::DESTINATION,         ShipItTransport::HTTPS,         MyGitHubUtils::class,       ),       new ShipItCreateNewRepoPhase(),       new ShipItPullPhase(ShipItRepoSide::DESTINATION),       new ShipItSyncPhase(         ($config, $changeset) ==> self::filterChangeset($changeset),         /* directories to run hg log/hg diff in: */ ImmSet { 'myproject/' },       ),       new ShipItPushPhase(),     };      (new ShipItPhaseRunner($config, $phases))->run();   } }  // Allow require() from unit test if (isset($argv) &amp;&amp; idx($argv, 0) === realpath(__FILE__)) {   ShipMyProject::cliMain(); } &lt;?hh  namespace Facebook\ImportIt;  use type Facebook\ShipIt\ {   MyGitHubUtils,   MySourceRepoInitPhase,   ShipItBaseConfig,   ShipItChangeset,   ShipItCleanPhase,   ShipItPullPhase,   ShipItRepoSide,   ShipItTransport };  class ImportMyProject {    public static function filterChangeset(     ShipItChangeset $changeset,   ): ShipItChangeset {     return $changeset       |> ImportItPathFilters::moveDirectories(           $$,           ShipMyProject::getPathMappings(),         );   }    public static function cliMain(): void {     // The repository state will be updated and modified, so we need to use a     // consistent destination repository for all ImportIt phases.     $source_repo_getter = (ShipItBaseConfig $c) ==> {       return new ImportItRepoGIT(         $c->getSourcePath(),         $c->getSourceBranch(),       );     };      (new ShipItPhaseRunner(       new ShipItBaseConfig(         /* default working dir = */ '/var/tmp/shipit',         'source_dir_name',         'dest_dir_name',       ),       ImmVector {         new MySourceRepoInitPhase(/* ... */ ),         new ShipItCleanPhase(ShipItRepoSide::DESTINATION),         new ShipItPullPhase(ShipItRepoSide::DESTINATION),         new ShipItGitHubInitPhase(           'my-github-org',           'my-github-project',           ShipItRepoSide::SOURCE,           ShipItTransport::HTTPS,           MyGitHubUtils::class,         ),         new ShipItCleanPhase(ShipItRepoSide::SOURCE),         new ShipItPullPhase(ShipItRepoSide::SOURCE),         new ImportItCheckoutBaseRevisionPhase($source_repo_getter),         new ImportItApplyPatchPhase(           $source_repo_getter,           ShipItRepoSide::SOURCE,         ),         new ImportItApplyPatchPhase(           $source_repo_getter,           ShipItRepoSide::DESTINATION,           $changeset ==> self::filterChangeset($changeset),         ),       },     ))       ->run();   } }  // Allow require() from unit test if (isset($argv) &amp;&amp; idx($argv, 0) === realpath(__FILE__)) {   ImportMyProject::cliMain(); }
